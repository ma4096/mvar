
\documentclass[11pt,a4paper,sans]{article}

% Kopiert von https://tex.stackexchange.com/questions/474397/populate-information-from-a-csv-file-into-a-latex-document-specifically-into-th/474404#474404
\usepackage{expl3}
\usepackage{xparse}
\usepackage{forloop}

\ExplSyntaxOn
% seq: Queues
% Doku: https://texdoc.org/serve/interface3/0
% Tutorial: https://www.alanshawn.com/latex3-tutorial/#method-2-use-exp_argsn-functions-v4-v5-v6
\newcommand{\loadvariables}[2]{
	\krishna_csv_load:nn {#1} {#2} 
	%\tl_set:Nx \l_tmpd_tl {\seq_count:c {l__krishna_ #1_seq}}
	%\newcounter{x}
	%\forloop{x}{1}{\value{x} < \int_eval:n {\l_tmpd_tl + 1}}{
		%\tl_set:Nn \l_tmptr_tl {\GetCSV{#1}{\arabic{x}}{1}}
		%\tl_set:Nn \l_tmprb_tl {\GetCSV{#1}{\arabic{x}}{2}}
		%\cs_new:cx {#1\l_tmptr_tl~:}{\l_tmprb_tl}
		%\cs_new_eq:cc {#1\l_tmptr_tl} {#1\l_tmptr_tl~:}%\krishna_csv_get:nnn
		
	%}
}

\ior_new:N \l__krishna_ior_tmpa
\cs_new:Npn \krishna_csv_load:nn #1 #2 %#2: Dateiname, #1: Name der CSV intern
{
	\cs_if_free:cTF { l__krishna_ #1 _seq }
	% guckt nach, ob \l__krishna_ #1_seq  noch nicht existiert
	{ \__krishna_csv_load:nn { l__krishna_ #1 } {#2} } % springt immer hier hin, da immer war
	{ \msg_error:nnn { krishna / csv } { name-used } {#1} }
}
\cs_new:Npn \__krishna_csv_load:nn #1 #2 %#2: Dateiname
{
	\ior_open:Nn \l__krishna_ior_tmpa {#2}
	\seq_new:c { #1 _seq } % l__krishna_ #1_seq, das was vorher als frei registriert wurde
	\exp_args:Nc \__krishna_csv_read:N { #1 _seq } % fully expanded
	\ior_close:N \l__krishna_ior_tmpa
}
\cs_new:Npn \__krishna_csv_read:N #1
{
	%\ior_str_map_inline:Nn \l__krishna_ior_tmpa  { \seq_put_right:Nn #1 {##1} }
	\ior_str_map_inline:Nn \l__krishna_ior_tmpa  { \seq_put_right:Nn #1 {##1} }
}
\cs_new:Npn \krishna_csv_get:nnn #1 #2 #3
{
	\exp_args:Nf
	\clist_item:nn % comma list
	{ \seq_item:cn { l__krishna_ #1 _seq } {#2} } %c damit das erste Argument als command geparsed wird
	{#3}
}
\msg_new:nnn { krishna / csv } { name-used }
{ The~CSV~name~`#1'~is~already~taken }
\cs_new_eq:NN \LoadCSV \krishna_csv_load:nn
\cs_new_eq:NN \GetCSV \krishna_csv_get:nnn

% experimental from 
% https://tex.stackexchange.com/questions/257056/expl3-constructing-command-sequences-from-macro-arguments
%\NewDocumentCommand{\foo}{mmm}{%
	%\cs_new:cn {#1#2:}{#3}
	%\cs_new_eq:cc {#1#2} {#1#2:}%\krishna_csv_get:nnn
%}

%\NewDocumentCommand{\foocall}{}{%
%	\foo{t}{start}{4gj5} % define \foo_start:
	%\test_start: 
	%\tstart:
%}
\ExplSyntaxOff
%\foocall
\begin{document}
	%\makecvtitle
	\loadvariables{t}{../matlab/test.txt}
	\loadvariables{d}{test.txt}
	test
	
	%\GetCSV{t}{1}{2}
	
	\tb
	
	\tc
	
	\tchr
	
	%$\tchr$
	%\tstart
	%\MLtransfer{t}{test.txt}
	%\@namedef{ab}{cd}
%	\ab
	%\GetCSV{mycsv}{1}{1}
	
	%\GetCSV{mycsv}{1}{2}
	
	
	%\GetCSV{mycsv}{2}{1}
	
	%\GetCSV{mycsv}{3}{1}
\end{document}